import { BrowserRouter as Router, Routes, Route } from "react-router-dom";
import { LandingPage } from "./components/landing/LandingPage";
import { useForm } from "react-hook-form";
import React, { useState } from 'react';
import { createReport } from "./services/reports";


export const ReportForm = () => {
    console.log('ReportForm component is being rendered!');
    const { register, handleSubmit, formState: { errors }, reset } = useForm();
    
    

    const onSubmit = async (data: any) => {
        const result = await createReport(data);
        try {
          const response = await fetch('https://dummyjson.com/posts/add', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              title: data.location,
              body: data.description,
              tags: [data.pollution_type],
              userId: 1
            })
          });
      
          const result = await response.json();
          console.log('Submitted to dummyjson:', result);
          alert('Submitted successfully!');
          reset();
        } catch (error) {
          console.error('Error submitting:', error);
          alert('Something went wrong while submitting.');
        }
        
      };
    return (
        
        <div>
            <form id="report-form" onSubmit={handleSubmit(onSubmit)}>
                <div className="location-and-pollution">
                <div>
                    <label htmlFor="location">Location:</label>
                    <input {...register("location", { required: true })} />
                    
                </div>

                <div className="description">
                    <label htmlFor="description">Description:</label>
                    <input {...register("description", { required: true })} />
                </div>

                <div className="pollution-type">
                <label htmlFor="pollutionType">pollutionType:</label>
                    <select {...register("pollution_type", { required: true })}>
                    <option value="Plastic">Plastic</option>
                    <option value="Oil Spill">Oil Spill</option>
                    <option value="Chemical">Chemical</option>
                   </select>
                   </div>
                   </div>

                
                <input type="submit" value="Submit" />
            </form>
        </div>
    );
}
